#!/bin/bash
# Deploy to Cloudflare Pages (via git push)

# Color codes
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

echo -e "${BLUE}Trust Route Deployment${NC}"

# Check git status
if [[ -n $(git status -s) ]]; then
  echo -e "${YELLOW}⚠ You have uncommitted changes:${NC}"
  git status -s
  echo ""
  echo -e "${YELLOW}Run /commit-push first to commit changes${NC}"
  exit 1
fi

# Check if we're on main branch
CURRENT_BRANCH=$(git branch --show-current)
if [ "$CURRENT_BRANCH" != "main" ]; then
  echo -e "${YELLOW}⚠ You are on branch '$CURRENT_BRANCH', not 'main'${NC}"
  echo -e "${YELLOW}Switch to main branch first${NC}"
  exit 1
fi

# Push to origin
echo -e "${GREEN}Pushing to origin/main...${NC}"
git push origin main

echo -e "${GREEN}✓ Pushed to GitHub!${NC}"
echo ""
echo -e "${BLUE}Cloudflare Pages deployment started...${NC}"
echo -e "${YELLOW}Production:${NC} https://kpopeats.cc"
echo -e "${YELLOW}Preview:${NC} https://week1-public.pages.dev"
echo ""
echo -e "${YELLOW}Deployment typically completes in 1-2 minutes${NC}"
echo -e "${BLUE}Check status:${NC} https://dash.cloudflare.com"
